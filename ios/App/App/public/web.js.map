{"version":3,"sources":["./node_modules/@capacitor/camera/dist/esm/web.js"],"names":["CameraWeb","WebPlugin","getPhoto","options","Promise","resolve","reject","webUseInput","source","CameraSource","Photos","fileInputExperience","Prompt","actionSheet","document","querySelector","createElement","body","appendChild","header","promptLabelHeader","cancelable","title","promptLabelPhoto","promptLabelPicture","addEventListener","e","selection","detail","cameraExperience","customElements","get","cameraModal","componentOnReady","photo","CapacitorException","Error","_getCameraPhoto","dismiss","removeChild","present","console","error","input","cleanup","_a","parentNode","id","type","hidden","_e","file","files","format","resultType","reader","FileReader","dataUrl","result","b64","split","base64String","readAsDataURL","webPath","URL","createObjectURL","accept","capture","removeAttribute","direction","CameraDirection","Front","Rear","click","onloadend","r","onerror","checkPermissions","navigator","permissions","unavailable","permission","window","query","name","camera","state","photos","requestPermissions","unimplemented","Camera"],"mappings":"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","file":"web.js","sourcesContent":["import { WebPlugin, CapacitorException } from '@capacitor/core';\nimport { CameraSource, CameraDirection } from './definitions';\nexport class CameraWeb extends WebPlugin {\n    async getPhoto(options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve, reject) => {\n            if (options.webUseInput || options.source === CameraSource.Photos) {\n                this.fileInputExperience(options, resolve);\n            }\n            else if (options.source === CameraSource.Prompt) {\n                let actionSheet = document.querySelector('pwa-action-sheet');\n                if (!actionSheet) {\n                    actionSheet = document.createElement('pwa-action-sheet');\n                    document.body.appendChild(actionSheet);\n                }\n                actionSheet.header = options.promptLabelHeader || 'Photo';\n                actionSheet.cancelable = false;\n                actionSheet.options = [\n                    { title: options.promptLabelPhoto || 'From Photos' },\n                    { title: options.promptLabelPicture || 'Take Picture' },\n                ];\n                actionSheet.addEventListener('onSelection', async (e) => {\n                    const selection = e.detail;\n                    if (selection === 0) {\n                        this.fileInputExperience(options, resolve);\n                    }\n                    else {\n                        this.cameraExperience(options, resolve, reject);\n                    }\n                });\n            }\n            else {\n                this.cameraExperience(options, resolve, reject);\n            }\n        });\n    }\n    async cameraExperience(options, resolve, reject) {\n        if (customElements.get('pwa-camera-modal')) {\n            const cameraModal = document.createElement('pwa-camera-modal');\n            document.body.appendChild(cameraModal);\n            try {\n                await cameraModal.componentOnReady();\n                cameraModal.addEventListener('onPhoto', async (e) => {\n                    const photo = e.detail;\n                    if (photo === null) {\n                        reject(new CapacitorException('User cancelled photos app'));\n                    }\n                    else if (photo instanceof Error) {\n                        reject(photo);\n                    }\n                    else {\n                        resolve(await this._getCameraPhoto(photo, options));\n                    }\n                    cameraModal.dismiss();\n                    document.body.removeChild(cameraModal);\n                });\n                cameraModal.present();\n            }\n            catch (e) {\n                this.fileInputExperience(options, resolve);\n            }\n        }\n        else {\n            console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements.`);\n            this.fileInputExperience(options, resolve);\n        }\n    }\n    fileInputExperience(options, resolve) {\n        let input = document.querySelector('#_capacitor-camera-input');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input';\n            input.type = 'file';\n            input.hidden = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const file = input.files[0];\n                let format = 'jpeg';\n                if (file.type === 'image/png') {\n                    format = 'png';\n                }\n                else if (file.type === 'image/gif') {\n                    format = 'gif';\n                }\n                if (options.resultType === 'dataUrl' ||\n                    options.resultType === 'base64') {\n                    const reader = new FileReader();\n                    reader.addEventListener('load', () => {\n                        if (options.resultType === 'dataUrl') {\n                            resolve({\n                                dataUrl: reader.result,\n                                format,\n                            });\n                        }\n                        else if (options.resultType === 'base64') {\n                            const b64 = reader.result.split(',')[1];\n                            resolve({\n                                base64String: b64,\n                                format,\n                            });\n                        }\n                        cleanup();\n                    });\n                    reader.readAsDataURL(file);\n                }\n                else {\n                    resolve({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                    cleanup();\n                }\n            });\n        }\n        input.accept = 'image/*';\n        input.capture = true;\n        if (options.source === CameraSource.Photos ||\n            options.source === CameraSource.Prompt) {\n            input.removeAttribute('capture');\n        }\n        else if (options.direction === CameraDirection.Front) {\n            input.capture = 'user';\n        }\n        else if (options.direction === CameraDirection.Rear) {\n            input.capture = 'environment';\n        }\n        input.click();\n    }\n    _getCameraPhoto(photo, options) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            const format = photo.type.split('/')[1];\n            if (options.resultType === 'uri') {\n                resolve({\n                    webPath: URL.createObjectURL(photo),\n                    format: format,\n                });\n            }\n            else {\n                reader.readAsDataURL(photo);\n                reader.onloadend = () => {\n                    const r = reader.result;\n                    if (options.resultType === 'dataUrl') {\n                        resolve({\n                            dataUrl: r,\n                            format: format,\n                        });\n                    }\n                    else {\n                        resolve({\n                            base64String: r.split(',')[1],\n                            format: format,\n                        });\n                    }\n                };\n                reader.onerror = e => {\n                    reject(e);\n                };\n            }\n        });\n    }\n    async checkPermissions() {\n        if (typeof navigator === 'undefined' || !navigator.permissions) {\n            throw this.unavailable('Permissions API not available in this browser');\n        }\n        try {\n            // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n            // the specific permissions that are supported varies among browsers that implement the\n            // permissions API, so we need a try/catch in case 'camera' is invalid\n            const permission = await window.navigator.permissions.query({\n                name: 'camera',\n            });\n            return {\n                camera: permission.state,\n                photos: 'granted',\n            };\n        }\n        catch (_a) {\n            throw this.unavailable('Camera permissions are not available in this browser');\n        }\n    }\n    async requestPermissions() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n}\nconst Camera = new CameraWeb();\nexport { Camera };\n//# sourceMappingURL=web.js.map"],"sourceRoot":"webpack:///"}